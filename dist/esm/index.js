import{Center as e,VStack as n,Text as t,Divider as r,Box as o,Button as a,ChakraProvider as l}from"@chakra-ui/react";import i,{useState as c,useRef as u}from"react";var s=function(l){var s,d=l.email,f=l.logout,m=l.sendEmail,v=function(){var e=c(0),n=e[0],t=e[1],r=u();return{seconds:n,startCountDown:function(e){r.current||(t(e),r.current=setInterval((function(){t((function(e){return e<0?(clearInterval(r.current),r.current=void 0,0):e-1}))}),1e3))}}}(),h=v.seconds,p=v.startCountDown,y=function(e){var n=c({loading:!1,called:!1}),t=n[0],r=n[1];return[t,function(){return r({loading:!0,called:!0}),e().then((function(e){return r({loading:!1,called:!0}),e})).catch((function(e){console.error(e),r({loading:!1,called:!0,error:e})}))}]}(m),b=y[0],g=b.error,w=b.loading,E=b.called,k=y[1],x=429===(null===(s=null==g?void 0:g.response)||void 0===s?void 0:s.status),C=x?"You've sent to many requests, please try again later.":"An error occurred, please try again.";return i.createElement(e,{h:"90vh",m:"auto"},i.createElement(n,{align:"center",w:"40vw",textAlign:"center",spacing:8},i.createElement(t,{fontSize:"2xl"},"Almost there â€¦"),i.createElement(t,null,"Please check your email ",i.createElement("b",null,d)," to confirm your account."),i.createElement(r,null),i.createElement(t,null,"If ",i.createElement("b",null,d)," is not your email address, please"," ",i.createElement(o,{display:"contents",textDecoration:"underline",color:"blue",cursor:"pointer",onClick:function(){return f()}},"click here to go back")," ","and enter the correct one."," "),i.createElement(t,null,"If you have not received our email in 15 minutes, please check your spam folder."),i.createElement(n,null,i.createElement(t,null,"Still can't find it?"),!x&&i.createElement(a,{onClick:function(){return k().then((function(e){var n;p(30),(null===(n=null==e?void 0:e.data)||void 0===n?void 0:n.url)&&(window.location.href=e.data.url)}))},variant:"invertedPrimary",w:"fit-content",px:"6",size:"sm",ml:"3",disabled:w||h>0},w?"Loading...":"Resend verification email"),!w&&E&&i.createElement(t,{color:g?"warning.600":"secondary.500"},g?C:"Your verification email has been sent, please check your inbox."),h>0&&i.createElement(t,{fontSize:"xs"},"You can try again in ",h))))},d=function(){return i.createElement(l,null,i.createElement(e,{h:"100vh"},i.createElement(n,{textAlign:"center",spacing:"6"},i.createElement(t,null,"Your email has been verified ðŸŽ‰"),i.createElement(a,{onClick:function(){return window.location.assign("/admin")}},"Continue to UseCSV"))))},f=function(e){var n=e.children,t=e.logout,r=e.sendVerifyEmail,o=new URLSearchParams(window.location.search).get("error_description"),a="string"==typeof o&&window.atob(o),l=a?JSON.parse(a):{},c=l.email,u=l.userId;return"email_not_verified"!==l.errorCode?i.createElement(i.Fragment,null,n):i.createElement(s,{sendEmail:function(){return r(u)},logout:t,email:c})};function m(e,n,t,r){return new(t||(t=Promise))((function(o,a){function l(e){try{c(r.next(e))}catch(e){a(e)}}function i(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(l,i)}c((r=r.apply(e,n||[])).next())}))}function v(e,n){var t,r,o,a,l={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function i(a){return function(i){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;l;)try{if(t=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return l.label++,{value:a[1],done:!1};case 5:l.label++,r=a[1],a=[0];continue;case 7:a=l.ops.pop(),l.trys.pop();continue;default:if(!(o=l.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){l=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){l.label=a[1];break}if(6===a[0]&&l.label<o[1]){l.label=o[1],o=a;break}if(o&&l.label<o[2]){l.label=o[2],l.ops.push(a);break}o[2]&&l.ops.pop(),l.trys.pop();continue}a=n.call(e,l)}catch(e){a=[6,e],r=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,i])}}}var h=function(e,n,t,r){return m(void 0,void 0,void 0,(function(){var o,a;return v(this,(function(l){switch(l.label){case 0:return[4,t(e.body.id)];case 1:return o=l.sent(),(a=o.data)||n.status(404).end(),a.email_verified&&n.json({url:"/admin"}),[4,r(e.body.id,a.email)];case 2:return l.sent(),n.status(200).end(),[2]}}))}))};export{f as CheckEmailVerification,d as EmailVerifiedNextPage,s as VerifyYourAccount,h as sendVerificationEmailHandler};
//# sourceMappingURL=index.js.map
